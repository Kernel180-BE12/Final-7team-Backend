//package com.softlabs.aicontents;
//
//import org.junit.jupiter.api.Test;
//import org.springframework.beans.factory.annotation.Autowired;
//import org.springframework.boot.test.context.SpringBootTest;
//import org.springframework.jdbc.core.JdbcTemplate;
//
//
//import static org.assertj.core.api.Assertions.assertThat;
//
//
//import javax.sql.DataSource;
//import java.sql.Connection;
//import java.util.List;
//import java.util.Map;
//
//@SpringBootApplication(scanBasePackages = "com.softlabs.aicontents")
//public class RdsConnectionTest {
//
//    @Autowired
//    private DataSource dataSource;
//
//    @Autowired
//    private JdbcTemplate jdbcTemplate;
//
//    @Test
//    void testBasicRdsConnection() {
//        System.out.println(" RDS ì—°ê²° í…Œì´ìŠ¤________");
//
//        try(Connection connection = dataSource.getConnection()){
//
//            //ì—°ê²° ì„±ê³µ ê²€ì¦
//            assertThat(connection).isNotNull();
//            assertThat(connection.isValid(10)).isTrue();
//
//            //ì—°ê²° ì •ë³´ ì¶œë ¥
//            System.out.println("RDS ì—°ê²° ì„±ê³µ ");
//            System.out.println("DB URL : "+ connection.getMetaData().getURL());
//            System.out.println("ì‚¬ìš©ì: " + connection.getMetaData().getUserName());
//            System.out.println("DB ì œí’ˆ :" + connection.getMetaData().getDatabaseProductName());
//            System.out.println(" ë²„ì „ : " + connection.getMetaData().getDatabaseProductVersion());
//
//        } catch(Exception e) {
//            System.out.println(" RDS ì—°ê²° ì‹¤íŒ¨: " + e.getMessage());
//            e.printStackTrace();
//            throw new RuntimeException("RDS ì—°ê²° ì‹¤íŒ¨ ",e );
//        }
//
//    }
//
//
//    @Test
//    void testBasicQuery(){
//        System.out.println("ê¸°ë³¸ ì¿¼ë¦¬ í…ŒìŠ¤íŠ¸");
//
//        try{
//            //Oracle ê¸°ë³¸ ì¿¼ë¦¬ ì‹¤í–‰
//            Map<String,Object> result = jdbcTemplate.queryForMap(
//                    "Select "+
//                            "'AWS RDS Oracle ì¿¼ë¦¬ ì„±ê³µ!! 'as message," +
//                            "TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS') AS CURRENT_TIME,"+
//                            "USER as CURRENT_USER," +
//                            "SYS_CONTEXT('USERENV','DB_NAME') as DATABASE_NAME"+
//                            "FROM dual"
//            );
//
//            assertThat(result).isNotNull();
//            assertThat(result.get("MESSAGE")).isEqualTo("AWS RDS Oracle ì¿¼ë¦¬ ì„±ê³µ!! ");
//
//            System.out.println("ì¿¼ë¦¬ ì‹¤í–‰ ì„±ê³µ");
//            System.out.println(" ë©”ì„¸ì§€ "+result.get("MESSAGE"));
//            System.out.println(" í˜„ì¬ì‹œê°„: "+ result.get("CURRENT_TIME"));
//            System.out.println(" ì‚¬ìš©ì: "+result.get("CURRENT_USER"));
//            System.out.println( "DB ì´ë¦„ :" + result.get("DATABASE_NAME"));
//
//        } catch(Exception e) {
//            System.err.println("ì¿¼ë¦¬ ì‹¤í–‰ ì‹¤íŒ¨ : "+ e.getMessage());
//            e.printStackTrace();
//            throw new RuntimeException("ì¿¼ë¦¬ ì‹¤í–‰ ì‹¤íŒ¨",e);
//        }
//    }
//    @Test
//    void testTableCreation(){
//        System.out.println("~~~~í…Œì´ë¸” ìƒì„± í…ŒìŠ¤íŠ¸~~~~");
//
//        try {
//            //í…ŒìŠ¤íŠ¸ìš© í…Œì´ë¸” ìƒì„±
//            String createTableSql  = """
//
//                    CREATE TABLE scheduler_test (
//                   test_id NUMBER(10) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
//                   test_message VARCHAR2(200),
//                   created_at TIMESTAMP DEFAULT SYSTIMESTAMP
//                    )
//                    """;
//            jdbcTemplate.execute(createTableSql );
//
//            System.out.println("í…Œì´ë¸” ìƒì„± ì„±ê³µ: scheduler_test");
//
//            //ë°ì´í„° ì‚½ì… í…ŒìŠ¤íŠ¸
//            jdbcTemplate.update(
//                    " INSERT INTO scheduler_test(test_message) values (?)",
//                    "RDS ì—°ê²° í…ŒìŠ¤íŠ¸ ì„±ê³µ!!!"
//            );
//            System.out.println("ë°ì´í„° ì‚½ì… ì„±ê³µ");
//
//            //ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸
//            List<Map<String, Object>> result = jdbcTemplate.queryForList(
//                    "SELECT test_id, test_message, TO_CHAR(created_at, 'YYYY-MM-DD HH24:MI:SS') as created_time " +
//                            "FROM scheduler_test ORDER BY test_id DESC"
//            );
//
//            assertThat(result).isNotNull();
//            System.out.println("ë°ì´í„° ì¡°íšŒ  ì„± ê³µ "+result.size()+"ê±´");
//
//            for(Map<String, Object> row : result){
//                System.out.println("ID"+row.get("TEST_ID") +", ë©”ì„¸ì§€: " +row.get("TEST_MESSAGE")+
//                        ", ì‹œê°„" +row.get("created_time"));
//            }
//
//            //í…ŒìŠ¤íŠ¸ í…Œì´ë¸” ì‚­ì œ
//            jdbcTemplate.execute("DROP TABLE scheduler_test");
//            System.out.println("í…ŒìŠ¤íŠ¸ í…Œì´ë¸” ì‚­ì œ ì™„ë£Œ ");
//
//        }  catch(Exception e) {
//            System.err.println("í…Œì´ë¸” í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ : "+e.getMessage());
//            e.printStackTrace();
//            throw new RuntimeException("í…Œì´ë¸” í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨",e);
//        }
//    }
//
//    @Test
//    void testConnectionPooling() {
//        System.out.println("ğŸŠ === ì»¤ë„¥ì…˜ í’€ í…ŒìŠ¤íŠ¸ ===");
//
//        try {
//            // ì—¬ëŸ¬ ì—°ê²° ë™ì‹œ í…ŒìŠ¤íŠ¸ (ì»¤ë„¥ì…˜ í’€ ê²€ì¦)
//            for (int i = 1; i <= 3; i++) {
//                try (Connection conn = dataSource.getConnection()) {
//                    String result = jdbcTemplate.queryForObject(
//                            "SELECT 'Connection #" + i + " - ' || TO_CHAR(SYSDATE, 'HH24:MI:SS') FROM dual",
//                            String.class
//                    );
//
//                    System.out.println("   ğŸ”— " + result);
//                    assertThat(result).contains("Connection #" + i);
//                }
//            }
//
//            System.out.println("âœ… ì»¤ë„¥ì…˜ í’€ í…ŒìŠ¤íŠ¸ ì„±ê³µ!");
//
//        } catch (Exception e) {
//            System.err.println("ğŸ’¥ ì»¤ë„¥ì…˜ í’€ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: " + e.getMessage());
//            throw new RuntimeException("ì»¤ë„¥ì…˜ í’€ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨", e);
//        }
//    }
//}
//
